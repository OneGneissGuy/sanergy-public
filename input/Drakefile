
wget_unzip()
        mkdir -p $(dirname $OUTPUT0)
        mkdir -p $(dirname $OUTPUT1)
        wget --output-document="$OUTPUT0" "$URL"
        unzip -o "$OUTPUT0" -d $(dirname $OUTPUT1)

extract_shapefiles_fromzip()
        DIRNAME=$(dirname $OUTPUT)
        BASENAME=$(basename $OUTPUT | sed 's/.shp//')
        unzip -joDD $INPUT */$BASENAME.* -d $DIRNAME

import_shapefile()
        BASENAME=$(basename $INPUT | sed 's/.shp//')
        BASENAME_LOWERCASE=$(echo $BASENAME | tr -d ':' | tr [:upper:] [:lower:])
        shp2pgsql -d -s 2274 $INPUT shapefiles."$BASENAME_LOWERCASE" | psql -q
        touch $OUTPUT


;;; SHAPEFILES ;;;
psql/input/shapefiles/SanergyFresh_Life_mapping_areas <- data/input/shapefiles/SanergyFresh_Life_mapping_areas.kml
	ogr2ogr -f "PostgreSQL" PG:"host=$PGHOST user=$PGUSER dbname=$PGDATABASE password=$PGPASSWORD active_schema=shapefiles" $INPUT
	touch $OUTPUT

psql/input/shapefiles/Map_Kibera/watsan <- data/input/shapefiles/Map_Kibera/Mathare-watsan-shapefile/watsan.shp [method:import_shapefile]


;;; IPA Survey ;;;
data/input/IPA/IPA_data_incomplete.csv <- data/input/IPA/IPA_data_incomplete.sav
	R CMD BATCH IPA_data_incomplete.R
data/input/IPA/IPA_data_incomplete_NAreplaced.csv <- data/input/IPA/IPA_data_incomplete.csv
	sed 's~"N/A"~~g' $INPUT > $OUTPUT
psql/input/ipa_data_incomplete_NAreplaced <- input/ipa_data_incompleteNAreplaced.sql, data/input/IPA/IPA_data_incomplete_NAreplaced.csv [method:psql]



;;; SQL SERVER DATA ;;;

